# 🔧 راهنمای کامل فعال‌سازی Telegram Trigger در N8N

## 📋 خلاصه مشکل
ورکفلو عمومی فعاله (بخش Chat کار میکنه) ولی Telegram Trigger node فعال نیست و به همین خاطر 403 برمیگردونه.

## 🎯 مراحل دقیق فعال‌سازی

### مرحله 1: ورود به N8N
1. به آدرس برید: **https://iqv2.onrender.com**
2. لاگین کنید
3. به لیست ورکفلوها برید

### مرحله 2: باز کردن ورکفلو
1. روی ورکفلو **ff17baeb-3182-41c4-b60a-e6159b02023b** کلیک کنید
2. یا مستقیم به این آدرس برید:  
   **https://iqv2.onrender.com/workflows/ff17baeb-3182-41c4-b60a-e6159b02023b**

### مرحله 3: یافتن Telegram Trigger Node
در صفحه ویرایش ورکفلو، دنبال گره **Telegram Trigger** بگردید. این گره معمولاً:
- در ابتدای workflow قرار داره
- شکل گربه داشته
- آیکون تلگرام روش باشه
- رنگش متفاوت از بقیه گره‌ها باشه

### مرحله 4: فعال‌سازی Telegram Trigger Node

#### گزینه A: دکمه Toggle روی Node خودش
1. روی گره **Telegram Trigger** کلیک کنید
2. در پنل سمت راست (Node Settings) دنبال **"Active"** یا **"Enable"** بگردید
3. دکمه Toggle رو پیدا کنید (🔴 = خاموش، 🟢 = روشن)
4. اگر قرمز بود، روش کلیک کنید تا سبز بشه
5. روی **"Save"** کلیک کنید

#### گزینه B: دکمه کنار نام Node
1. در workflow canvas، دنبال **"Telegram Trigger"** بگردید
2. در کنار نام گره (سمت راست یا پایین) دکمه کوچیکی هست
3. اگر دکمه قرمز (🔴) هست، روش کلیک کنید تا سبز (🟢) بشه
4. اگر سبز هست، یک بار خاموش و روشن کنید

#### گزینه C: منوی عملیات روی Node
1. روی گره **Telegram Trigger** کلیک راست کنید
2. گزینه **"Activate"** رو انتخاب کنید
3. یا **"Settings"** رو انتخاب کنید و در تنظیمات گزینه **"Active"** رو روشن کنید

### مرحله 5: بررسی تنظیمات اضافی
در تنظیمات Telegram Trigger، این گزینه‌ها رو چک کنید:

#### تنظیمات مهم:
- ✅ **"Use Production Environment"** یا **"Production Mode"** - روشن باشه
- ✅ **"Listen for Webhooks"** - فعال باشه
- ✅ **"Auto-activate"** یا **"Enable"** - روشن باشه
- ❌ **"Test Mode"** یا **"Manual Trigger"** - خاموش باشه

#### Bot Token:
- مطمئن بشید Bot Token درست تنظیم شده باشه
- Token: `1619184775:AAFn_CrQSkjPtk31kp9PpuxIdkEGDK4oRSc`

### مرحله 6: ذخیره و تست
1. روی دکمه **"Save"** کلیک کنید
2. ورکفلو رو ذخیره کنید
3. **5-10 ثانیه** صبر کنید
4. برای تست این اسکریپت رو اجرا کنید:
   ```bash
   python test_complete_system.py
   ```

## 🔍 نحوه تشخیص فعال بودن

### علامت‌های درست:
- گره Telegram Trigger سبز رنگ باشه (🟢)
- در Node Settings گزینه **"Active"** سبز باشه
- کد پاسخ از 403 به 200 تغییر کنه
- پیام‌هایی که به ربات میدید پاسخ داشته باشه

### علامت‌های مشکل:
- گره قرمز یا خاکستری باشه (🔴)
- هنوز خطای 403 می‌گیرید
- ربات جواب نمی‌ده

## 🚨 نکات مهم

### مشکل معمول:
شما احتمالاً یکی از این کارها رو انجام دادید:
1. ✅ ورکفلو عمومی رو فعال کردید (Chat کار میکنه)
2. ❌ Telegram Trigger Node رو فعال نکردید

### تفاوت:
- **Workflow Activation** = برای Chat section
- **Telegram Trigger Activation** = برای دریافت پیام‌های تلگرام

### اگر Telegram Trigger رو نمی‌بینید:
1. در صفحه ویرایش ورکفلو، نمایش رو روی **"All Nodes"** بذارید
2. از فیلتر "Telegram" استفاده کنید
3. دنبال نام **"Telegram"** یا **"Bot"** بگردید

## 📱 تست نهایی
بعد از فعال‌سازی:
1. به ربات @your_bot_name پیام بدید
2. باید عکس AI تولید و برگردانده بشه
3. اگه باز مشکل داشتید، لطفاً پیام بدید تا بررسی کنم

## 🆘 اگر باز فعال نشد:
لطفاً به من بگید:
1. آیا گره Telegram Trigger رو پیدا کردید؟
2. آیا دکمه Toggle روشن میشه؟
3. کدام دکمه رو باید کلیک کنید؟
4. چه پیام خطایی میبینید؟

با این راهنما حتماً درست میشه! 🚀