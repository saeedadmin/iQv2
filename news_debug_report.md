# گزارش عیب‌یابی و حل مشکل اخبار عمومی

## خلاصه مشکل
کاربر گزارش داد که در بخش اخبار عمومی:
- فقط 5 تا خبر دریافت می‌کند (باید 10+ باشد)
- خطاهایی در سیستم وجود دارد

## مراحل عیب‌یابی

### 1. تشخیص دقیق مشکل
✅ اسکریپت تست دقیق ایجاد شد (`test_general_news_detailed.py`)
✅ تمام 7 منبع RSS تست شدند
✅ مشکلات شناسایی شدند:
   - منبع "فارس" کاملاً خراب (HTML redirect به جای RSS)
   - محدودیت‌های خبر کم (2 برای منابع اصلی، 1 برای بین‌المللی)
   - خطای logger undefined در کد

### 2. تست منابع RSS

**منابع تست شده (7 مورد):**
1. خبرگزاری مهر ✅ (2 خبر)
2. تسنیم ✅ (2 خبر)
3. فارس ❌ (خطای XML - HTML redirect)
4. مهر - سیاسی ✅ (2 خبر)
5. تسنیم - بین‌الملل ✅ (1 خبر)
6. BBC World ✅ (1 خبر)
7. CNN World ✅ (1 خبر)

**نتیجه اولیه:** 9 خبر از 6 منبع موفق

### 3. پیدا کردن جایگزین
✅ منبع جایگزین پیدا شد: "مهر عمومی"
✅ URL: `https://www.mehrnews.com/rss/tp/1`
✅ تست شد: 35862 کاراکتر RSS معتبر

## راه‌حل‌های پیاده‌سازی شده

### 1. جایگزینی منبع خراب
```python
# قبلی (خراب):
{
    'name': 'فارس',
    'url': 'https://www.farsnews.ir/rss.xml',
    'limit': 2,
    'language': 'fa'
}

# جدید (کارکرده):
{
    'name': 'مهر عمومی',
    'url': 'https://www.mehrnews.com/rss/tp/1',
    'limit': 3,
    'language': 'fa'
}
```

### 2. افزایش محدودیت‌های خبر
- منابع اصلی فارسی: 2→3 خبر
- منابع بین‌المللی انگلیسی: 1→2 خبر

### 3. حل مشکل logger
```python
# اضافه شده در ابتدای فایل:
import logging
logger = logging.getLogger(__name__)
```

## نتایج تست نهایی

### بعد از تغییرات:
✅ **17 خبر** دریافت شد (هدف 10+ محقق شد)
✅ **7 منابع موفق** (0 منبع ناموفق)
✅ همه منابع Persian و English کار می‌کنند

**جزئیات منابع جدید:**
1. خبرگزاری مهر ✅ (3 خبر)
2. تسنیم ✅ (3 خبر)
3. مهر عمومی ✅ (3 خبر) - جایگزین فارس
4. مهر - سیاسی ✅ (2 خبر)
5. تسنیم - بین‌الملل ✅ (2 خبر)
6. BBC World ✅ (2 خبر)
7. CNN World ✅ (2 خبر)

## اقدامات Git انجام شده
✅ فایل‌های اصلاح شده commit شدند
✅ Commit hash: `c6d38dc`
✅ با موفقیت به GitHub push شد
✅ تغییرات آماده deployment

## خلاصه نهایی
🔧 **مشکل کاملاً حل شد:**
- از 9 خبر → **17 خبر** (+89% بهبود)
- از 6 منبع موفق → **7 منبع موفق** (100% success rate)
- هدف 10+ خبر محقق شد

🎯 **آماده برای production deployment**
