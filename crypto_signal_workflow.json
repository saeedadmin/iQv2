{"name": "Crypto Signal Monitor", "nodes": [{"parameters": {"resource": "trigger", "operation": "listen", "events": {"selectedOption": "specificEvents", "events": ["updateNewMessage", "updateNewChatMessage"]}, "chatFilter": {"include": ["@shervin_trading", "@uniopn"]}, "client": {"clientType": "userbot", "displayName": "Crypto Monitor Bot", "phone": "+989025988819", "username": "crypto_iq", "sessionName": "crypto_bot_session"}}, "id": "teleport-trigger-001", "name": "TelePilot Trigger", "type": "@telepilotco/n8n-nodes-telepilot.teleport", "typeVersion": 1, "position": [240, 300]}, {"parameters": {"mode": "runOnceForEachItem", "jsCode": "// تشخیص سیگنال کریپتو\nconst item = $input.first();\nconst message = item.json.message?.content?.text?.text || '';\nconst chatId = item.json.message?.chat_id;\n\n// کلمات کلیدی سیگنال\nconst keywords = [\n  'entry', 'Entry', 'ENTRY',\n  'stop', 'Stop', 'STOP',\n  'tp', 'TP', 'Tp', \n  'سیگنال اختصاصی',\n  'لوریج',\n  'buy', 'Buy', 'BUY',\n  'sell', 'Sell', 'SELL',\n  'target', 'Target', 'TARGET',\n  'long', 'Long', 'LONG',\n  'short', 'Short', 'SHORT'\n];\n\n// اموجی‌های مهم\nconst importantEmojis = ['💎', '🚀', '🔥', '⚡', '📈', '📊', '✅', '💰'];\n\n// تشخیص کلمات کلیدی\nconst foundKeywords = keywords.filter(keyword => message.toLowerCase().includes(keyword.toLowerCase()));\nconst foundEmojis = importantEmojis.filter(emoji => message.includes(emoji));\n\n// محاسبه confidence score\nlet confidence = 0;\nif (foundKeywords.length > 0) {\n  confidence += Math.min(foundKeywords.length * 25, 75); // حداکثر 75 امتیاز\n}\nif (foundEmojis.length > 0) {\n  confidence += foundEmojis.length * 10; // 10 امتیاز برای هر اموجی\n}\n\n// حداقل threshold برای سیگنال معتبر\nconst isValidSignal = confidence >= 50; // حداقل 50 امتیاز\n\n// خروجی\nreturn {\n  isValidSignal,\n  confidence,\n  foundKeywords,\n  foundEmojis,\n  originalMessage: message,\n  chatId,\n  timestamp: new Date().toISOString(),\n  message: message\n};"}, "id": "signal-detector-001", "name": "Signal Detector", "type": "n8n-nodes-base.code", "typeVersion": 2, "position": [460, 300]}, {"parameters": {"mode": "runOnceForEachItem", "jsCode": "// پاک کردن پیام از لینک‌ها و محتوای نامطلوب\nconst item = $input.first();\nconst originalMessage = item.json.message;\n\nif (!item.json.isValidSignal) {\n  // اگه سیگنال معتبر نبود، null برگردان\n  return null;\n}\n\n// پاک کردن لینک‌ها\nlet cleanMessage = originalMessage\n  .replace(/https?:\\/\\/[^\\s]+/g, '') // حذف لینک‌های http/https\n  .replace(/t\\.me\\/[^\\s]+/g, '') // حذف لینک‌های telegram\n  .replace(/@[A-Za-z0-9_]+/g, '') // حذف @mention\n  .replace(/#\\w+/g, '') // حذف hashtag\n  .replace(/\\s+/g, ' ') // یکسان‌سازی فاصله‌ها\n  .trim();\n\n// افزودن header برای سیگنال\nconst signalHeader = `🔔 **سیگنال کریپتو تشخیص داده شد**\\n`;\nconst confidenceText = `📊 Confidence: ${item.json.confidence}%\\n`;\nconst keywordsText = `🏷️ Keywords: ${item.json.foundKeywords.join(', ')}\\n\\n`;\n\n// پیام نهایی\nconst finalMessage = signalHeader + confidenceText + keywordsText + cleanMessage;\n\nreturn {\n  isValidSignal: true,\n  confidence: item.json.confidence,\n  foundKeywords: item.json.foundKeywords,\n  cleanMessage: finalMessage,\n  originalMessage: originalMessage,\n  timestamp: new Date().toISOString(),\n  chatId: item.json.chatId\n};"}, "id": "message-cleaner-001", "name": "Message Cleaner", "type": "n8n-nodes-base.code", "typeVersion": 2, "position": [680, 300]}, {"parameters": {"resource": "message", "operation": "sendMessage", "chatId": "YOUR_BOT_CHAT_ID", "text": "={{ $json.cleanMessage }}", "parseMode": "Markdown", "additionalFields": {"replyMarkup": {"inlineKeyboard": {"rows": [{"columns": 2, "rows": [{"text": "✅ تایید", "callbackData": "signal_approve"}, {"text": "❌ رد", "callbackData": "signal_reject"}]}]}}}}, "id": "send-to-bot-001", "name": "Send to Bot", "type": "n8n-nodes-base.telegram", "typeVersion": 1.1, "position": [900, 300], "credentials": {"telegramApi": {"id": "telegram_credentials_id", "name": "Telegram Bot API"}}}], "connections": {"TelePilot Trigger": {"main": [[{"node": "Signal Detector", "type": "main", "index": 0}]]}, "Signal Detector": {"main": [[{"node": "Message Cleaner", "type": "main", "index": 0}]]}, "Message Cleaner": {"main": [[{"node": "Send to Bot", "type": "main", "index": 0}]]}}, "settings": {"executionOrder": "v1"}, "staticData": null, "tags": [{"createdAt": "2025-10-25T00:58:53.000Z", "updatedAt": "2025-10-25T00:58:53.000Z", "id": "crypto-signals", "name": "Crypto Signals"}], "triggerCount": 1, "updatedAt": "2025-10-25T00:58:53.000Z", "versionId": "1"}