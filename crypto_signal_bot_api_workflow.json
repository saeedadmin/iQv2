{"name": "Crypto Signal Monitor - Bot API", "nodes": [{"parameters": {"updates": ["message"], "additionalFields": {"chatTypes": ["channel", "supergroup", "group"]}}, "id": "1", "name": "Telegram Trigger", "type": "n8n-nodes-base.telegramTrigger", "typeVersion": 1.1, "position": [240, 300], "credentials": {"telegramApi": {"id": "1", "name": "Crypto Bot API"}}}, {"parameters": {"jsCode": "// Crypto Signal Detection Logic\nconst message = items.json.message;\nconst text = message?.text || message?.caption || \"\";\nconst lowerText = text.toLowerCase();\n\n// کلمات کلیدی کریپتو (English + Persian)\nconst keywords = [\n  \"entry\", \"stop\", \"tp\", \"take profit\", \"target\",\n  \"لوریج\", \"سیگنال\", \"سیگنال اختصاصی برای\",\n  \"buy\", \"sell\", \"long\", \"short\",\n  \"binance\", \"coinbase\", \"btc\", \"eth\", \"crypto\",\n  \"bullish\", \"bearish\", \"pump\", \"dump\"\n];\n\n// پیدا کردن keywords موجود\nconst foundKeywords = keywords.filter(keyword => \n  lowerText.includes(keyword.toLowerCase())\n);\n\n// محاسبه confidence بر اساس keywords\nlet confidence = Math.min(foundKeywords.length * 15, 60);\n\n// اموجی‌های مهم کریپتو\nconst importantEmojis = [\"💎\", \"🚀\", \"🔥\", \"⚡\", \"📈\", \"📊\", \"📉\", \"💰\", \"💵\", \"🎯\", \"⚠️\", \"✅\"];\nconst foundEmojis = importantEmojis.filter(emoji => text.includes(emoji));\nconfidence += foundEmojis.length * 8;\n\n// حداقل threshold برای تشخیص سیگنال\nif (confidence >= 40) {\n  // تمیز کردن پیام از لینک‌ها، mention ها و hashtag ها\n  const cleanMessage = text\n    .replace(/https?:\\/\\/\\S+/g, \"\") // Remove URLs\n    .replace(/t\\.me\\/\\S+/g, \"\") // Remove t.me links\n    .replace(/@[A-Za-z0-9_]+/g, \"\") // Remove @mentions\n    .replace(/#\\w+/g, \"\") // Remove hashtags\n    .replace(/\\s+/g, \" \") // Normalize spaces\n    .trim();\n\n  return [{\n    json: {\n      confidence: confidence,\n      originalText: text,\n      cleanText: cleanMessage,\n      foundKeywords: foundKeywords,\n      foundEmojis: foundEmojis,\n      channel: message.chat?.title || message.chat?.username || 'Unknown',\n      chatId: message.chat?.id,\n      messageId: message.message_id,\n      date: new Date(message.date * 1000),\n      fromUser: message.from?.username || message.from?.first_name || 'Unknown'\n    }\n  }];\n}\n\n// اگه signal نیست، هیچ خروجی نده\nreturn [];"}, "id": "2", "name": "Signal Detector", "type": "n8n-nodes-base.code", "typeVersion": 2, "position": [460, 300]}, {"parameters": {"chatId": "-1001234567890", "text": "🔔 **Crypto Signal Detected**\\n\\n📊 **Confidence:** {{$node[\"Signal Detector\"].json[\"confidence\"]}}%\\n🏷️ **Keywords:** {{$node[\"Signal Detector\"].json[\"foundKeywords\"].join(\", \")}}\\n📢 **Channel:** {{$node[\"Signal Detector\"].json[\"channel\"]}}\\n\\n💬 **Signal:**\\n{{$node[\"Signal Detector\"].json[\"cleanText\"]}}\\n\\n⏰ **Time:** {{$node[\"Signal Detector\"].json[\"date\"]}}", "additionalFields": {"parse_mode": "Markdown"}}, "id": "3", "name": "Send Signal Alert", "type": "n8n-nodes-base.telegram", "typeVersion": 1.2, "position": [680, 300], "credentials": {"telegramApi": {"id": "1", "name": "Crypto Bot API"}}}], "connections": {"Telegram Trigger": {"main": [[{"node": "Signal Detector", "type": "main", "index": 0}]]}, "Signal Detector": {"main": [[{"node": "Send Signal Alert", "type": "main", "index": 0}]]}}, "settings": {"timezone": "Asia/Tehran", "saveManualExecutions": true, "callerPolicy": "workflowsFromSameOwner", "errorWorkflow": {}}, "staticData": {}, "tags": [], "triggerCount": 1, "updatedAt": "2025-10-25T02:38:27.000Z", "versionId": "1"}